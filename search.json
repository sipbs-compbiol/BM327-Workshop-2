[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "BM327 Workshop 2: Identifying UTI Adhesion Factors",
    "section": "",
    "text": "1 Preface\nWelcome to BM327 (Being a Biomolecular Scientist 3) bioinformatics workshop 2 for 2024-25.\nThis is the first presentation of this material, and we would be very grateful to hear feedback about it by email or through the GitHub repository Issues page.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "BM327 Workshop 2: Identifying UTI Adhesion Factors",
    "section": "1.1 Overview",
    "text": "1.1 Overview\nThis workshop asks you to carry out data analysis and visualisation to identify an adhesion factor important for urinary tract infection. You will be using the statistical programming language R and the widely-used graphics library ggplot2 to do this.\n\n\n\n\n\n\nImportant Note\n\n\n\nThere is new material in this workshop that is not covered in lectures, and this material is examinable. Please take care to read the text in the expandable callout boxes, as well as that for the workshop, to be sure you have understood the topic and obtain full value from the exercise.\nThe workshop material will remain live online for the duration of BM327, and you can revisit it whenever you wish, for practice or revision.\n\n\nYou should be able to complete this workshop in under two hours.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#learning-objectives",
    "href": "index.html#learning-objectives",
    "title": "BM327 Workshop 2: Identifying UTI Adhesion Factors",
    "section": "1.2 Learning Objectives",
    "text": "1.2 Learning Objectives\nBy the end of this workshop, students will be able to:\n\nPlot experimental data using R and ggplot2\nUse and interpret box-and-whisker, violin, and 1D scatter plots\nIdentify and understand how to correct for experimental batch effects\nPlot experimental data corrected for batch effects",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "index.html#assessment",
    "href": "index.html#assessment",
    "title": "BM327 Workshop 2: Identifying UTI Adhesion Factors",
    "section": "1.3 Assessment",
    "text": "1.3 Assessment\nThis workshop activity itself is not formally assessed although, as noted, all the material it contains is examinable. There is a formative assessment on MyPlace, which you should complete as part of the workshop.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Preface</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "2  Introduction",
    "section": "",
    "text": "The Introduction page is intended as a short introduction to the book.\nLike most Quarto books, this is a book created from markdown and executable code.\nThis kind of book is an example of literate programming - the intertwining of nicely-formatted text and images, and executable code. For example, the R code cell below executes and produces output when the book is compiled:\n\n1 + 1\n\n[1] 2\n\n\nBut the R code cell below does not:\n\nsummary(cars)\n\nSee Knuth (1984) for additional discussion of literate programming.\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "part_03_batches.html",
    "href": "part_03_batches.html",
    "title": "Correcting for batch effects",
    "section": "",
    "text": "In real life experiments are not always “clean,” in the sense that we cannot always construct our experiments to exclude all events or factors that might influence the outcome.\nIn this part of the workshop you will meet some real experimental data which, due to the need to spread the work over a period of months required parts of the experiment to be performed by different people at different times.\n\n\n\n\n\n\nCaution\n\n\n\nThe situation we consider here, where more than one researcher carries out sections of the experiment months apart, is quite obvious. The scientists involved knew that there might be an infuence on the outcome and took it into account when recording their data.\nHowever, many such interfering effects can creep into experimental data without our realising it. It is always good practice to investigate your experimental data to look for evidence of similar kinds of effects.\nAs you will see, it can be possible to account and correct for these effects when they arise.",
    "crumbs": [
      "Correcting for batch effects"
    ]
  },
  {
    "objectID": "visualising_batches.html",
    "href": "visualising_batches.html",
    "title": "3  Visualising Experimental Data",
    "section": "",
    "text": "3.1 Introduction\nThe experiment that was actually run to gather data on adherence to human tissue and catheter material ran into a few scheduling problems.\nUltimately the experiment was run by multiple scientists in the group, and measurements were taken in groups of five datapoints, where all five measurements - corresponding to a single bacterial line - were collected in the course of an afternoon. Each group, or batch, of five measurements contained results for only one of the WT (control), KO (knockout), empty (empty vector), and complement (complemented gene) lines. There were four such groups or batches for the human tissue experiment, and eight for the catheter material experiment. with four such batches of five measurements for each",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Visualising Experimental Data</span>"
    ]
  },
  {
    "objectID": "visualising_batches.html#task-1-load-and-inspect-your-data",
    "href": "visualising_batches.html#task-1-load-and-inspect-your-data",
    "title": "3  Visualising Experimental Data",
    "section": "3.2 Task 1: Load and inspect your data",
    "text": "3.2 Task 1: Load and inspect your data\nThere are two data files containing your experimental data: tissue.csv and catheter.csv.\n\n\n\n\n\n\nLoad your data from file\n\n\n\nUse the WebR cell below to load your data into two variables: tissue for the human tissue experiment, and catheter for the catheter material experiment.\n\n\n\n\n\n\nHint\n\n\n\n\n\nThe column types are, in order: factor, number, integer, number, integer, integer, integer and can be expressed as \"fniniii\" for the col_types option in read_csv()\n\n\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nI need a hint\n\n\n\n\n\n\nUse read_csv() to load your data into two different dataframes\nUse glimpse() or head() to inspect the format of your data\n\n\n\n\n\n\n\n\n\n\nHelp, I’m stuck!\n\n\n\n\n\nUse the R code below to load your data\ntissue &lt;- read_csv(\"tissue.csv\", col_types=\"fniniii\")\ncatheter &lt;- read_csv(\"catheter.csv\", col_types=\"fniniii\")\nUse the R code below to inspect your data\nglimpse(tissue)\nglimpse(catheter)\n\n\n\n\n3.2.1 The format of your dataset\nYour dataset has been provided in a specific format to make plotting and analysis easier for this workshop.\n\n\n\n\n\n\nNote\n\n\n\nThis workshop focuses on demonstrating how to visualise, analyse, and interpret experimental data. The principles and techniques of cleaning and manipulating raw data into a suitable form for analysis is outside the scope of this material.\n\n\n\n\n\n\n\n\nCallout-todo\n\n\n\nExplain the meanings of the columns and why they are the datatypes they are.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Visualising Experimental Data</span>"
    ]
  },
  {
    "objectID": "visualising_batches.html#visualise-the-datasets",
    "href": "visualising_batches.html#visualise-the-datasets",
    "title": "3  Visualising Experimental Data",
    "section": "3.3 Visualise the datasets",
    "text": "3.3 Visualise the datasets\n\n3.3.1 The catheter material dataset\n\n\n\n\n\n\nVisualise the catheter dataset\n\n\n\nUse the WebR cell below to visualise the data from the catheter material experiment.\nSee if you can give the graph these properties:\n\nThe categories/labels should be in this order on the x-axis, from left to right: WT, KO, empty, complement\nThere should be one boxplot per category/label\nEach batch should be assigned a different colour for easy identification\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nI need a hint!\n\n\n\n\n\n\nYou can order the categories on the x-axis by replacing x=label with x=factor(label, level=c(\"WT\", \"KO\", \"empty\", \"complement\")\nIf you use aes(colour=batch) in the ggplot() base layer, then the boxplots will be split. To avoid this, use aes(colour=factor(batch)) in geom_jitter() instead.\n\n\n\n\n\n\n\n\n\n\nHelp, I’m stuck!\n\n\n\n\n\nUse the R code below to render your graph:\np1 &lt;- ggplot(catheter,\n             aes(x=factor(label, level=c(\"WT\", \"KO\", \"empty\", \"complement\")),\n                 y=logCFU)) +\n  geom_boxplot() +\n  geom_jitter(width=0.2,\n              aes(colour=factor(batch))) +\n  xlab(\"experiment\")\np1\n\n\n\n\n\n3.3.2 The human tissue dataset\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nI need a hint\n\n\n\n\n\nYou can use almost exactly the same solution as for the catheter dataset, but:\n\nchange p1 to p2 to create a new graph rather than overwriting the old one\nmake sure you are working with the tissue dataset\n\n\n\n\n\n\n\n\n\n\nHelp, I’m stuck!\n\n\n\n\n\nUse the R code below to render your graph:\np2 &lt;- ggplot(tissue,\n             aes(x=factor(label, level=c(\"WT\", \"KO\", \"empty\", \"complement\")),\n                 y=logCFU)) +\n  geom_boxplot() +\n  geom_jitter(width=0.2,\n              aes(colour=factor(batch))) +\n  xlab(\"experiment\")\np2",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Visualising Experimental Data</span>"
    ]
  },
  {
    "objectID": "visualising_batches.html#interpret-the-data",
    "href": "visualising_batches.html#interpret-the-data",
    "title": "3  Visualising Experimental Data",
    "section": "3.4 Interpret the data",
    "text": "3.4 Interpret the data\n\n3.4.1 The catheter material dataset\nYour plot of the catheter data should look similar to that in Figure 3.1.\nThe y-axis shows the log of the colony-forming units (CFU) per millilitre, and is a measure of the amount of each type of bacteria (wild-type/control, etpD knockout, knockout with empty vector, and complemented knockout) that were recovered. The x-axis gathers the datpoints for each type of bacteria.\nEach boxplot shows the median value as a thick horizontal line, a box extending from the 25th and 75th percentiles, and whiskers extending to no more than 1.5 \\(\\times\\) the interquartile range (IQR) of the data. Datapoints beyond the whiskers can be considered as outliers.\nExamine your plot (or Figure 3.1) and consider the questions below.\n\n\n\n\n\n\n\n\nFigure 3.1\n\n\n\n\n3.4.1.1 What is the overall effect of each bacterial variant?\n\n\n\n\n\n\nQuestions\n\n\n\nThe median logCFU of the wild-type (WT) control is approximately 6.35. What is the approximate logCFU of each of the three bacterial lines?\n\nKO (the etpD knockout)\nempty (the etpD knockout carrying an empty plasmid vector)\ncomplement (the etpD knockout carrying a plasmid vector that expresses the etpD gene)\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n\nThe KO line has a median logCFU of 6.13\nThe empty line has a median logCFU of 5.86\nThe complement line has a median logCFU of 6.46\n\n\n\n\n\n\n\n\n\n\nQuestions\n\n\n\nTaking the wild-type WT line as a baseline level of “stickiness” to the catheter material. Based only on your graph (or Figure 3.1) Is the “stickiness” of each of the three remaining bacterial lines approximately greater than, less than, or about the same as the wild type?\n\nKO (the etpD knockout)\nempty (the etpD knockout carrying an empty plasmid vector)\ncomplement (the etpD knockout carrying a plasmid vector that expresses the etpD gene)\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n\nFewer CFUs/mL are recovered from the KO line, so it seems to be less “sticky” than the wild type\nFewer CFUs/mL are recovered from the empty line, so it seems to be less “sticky” than the wild type\nAbout the same CFUs/mL are recovered from the complement line, so it seems to be about as “sticky” as the wild type\n\n\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nDoes the empty line appear to be more “sticky”, less “sticky”, or just about as “sticky” as the KO line?\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\nFewer CFUs/mL are recovered from the empty line, so it appears to be less “sticky” than the KO line.\n\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nBased on your answers above, do you think there is evidence that the etpD gene might contribute to adhesion of the bacteria to catheter material?\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\nWhen the etpD gene is knocked out (KO) fewer CFUs are recovered from the substrate, which we can interpret as the bacteria being less “sticky.”\nSimilarly, when the etpD gene is expressed from a plasmid (complement) more CFUs are recovered than was the case for the KO, so it appears that restoration of the etpD gene might make the bacteria more “sticky,” i.e. contribute to increased adherence.\n\n\n\n\n\n\n3.4.2 The tissue material dataset\nYour plot of the tissue data should look similar to that in Figure 3.2.\nThe y-axis shows the log of the colony-forming units (CFU) per millilitre, and is a measure of the amount of each type of bacteria (wild-type/control, etpD knockout, knockout with empty vector, and complemented knockout) that were recovered. The x-axis gathers the datpoints for each type of bacteria.\nEach boxplot shows the median value as a thick horizontal line, a box extending from the 25th and 75th percentiles, and whiskers extending to no more than 1.5 \\(\\times\\) the interquartile range (IQR) of the data. Datapoints beyond the whiskers can be considered as outliers.\nExamine your plot (or Figure 3.2) and consider the questions below.\n\n\n\n\n\n\n\n\nFigure 3.2\n\n\n\n\n3.4.2.1 What is the overall effect of each bacterial variant?\n\n\n\n\n\n\nQuestions\n\n\n\nThe median logCFU of the wild-type (WT) control is approximately 6.61. What is the approximate logCFU of each of the three bacterial lines?\n\nKO (the etpD knockout)\nempty (the etpD knockout carrying an empty plasmid vector)\ncomplement (the etpD knockout carrying a plasmid vector that expresses the etpD gene)\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n\nThe KO line has a median logCFU of 6.24\nThe empty line has a median logCFU of 6.22\nThe complement line has a median logCFU of 6.24\n\n\n\n\n\n\n\n\n\n\nQuestions\n\n\n\nTaking the wild-type WT line as a baseline level of “stickiness” to the catheter material. Based only on your graph (or Figure 3.1) Is the “stickiness” of each of the three remaining bacterial lines approximately greater than, less than, or about the same as the wild type?\n\nKO (the etpD knockout)\nempty (the etpD knockout carrying an empty plasmid vector)\ncomplement (the etpD knockout carrying a plasmid vector that expresses the etpD gene)\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n\nFewer CFUs/mL are recovered from the KO line, so it seems to be less “sticky” than the wild type\nFewer CFUs/mL are recovered from the empty line, so it seems to be less “sticky” than the wild type\nFewer CFUs/mL are recovered from the complement line, so it seems to be less “sticky” than the wild type\n\n\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nDoes the empty line appear to be more “sticky”, less “sticky”, or just about as “sticky” as the KO line?\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\nAbout the same level of CFUs/mL are recovered from the empty line, so it appears to be approximately as “sticky” as the KO line.\n\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nBased on your answers above, do you think there is evidence that the etpD gene might contribute to adhesion of the bacteria to catheter material?\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\nWhen the etpD gene is knocked out (KO) fewer CFUs are recovered from the substrate, which we can interpret as the bacteria being less “sticky.”\nHowever, when the etpD gene is expressed from a plasmid (complement) no more CFUs are recovered than was the case for the KO, so it appears that restoration of the etpD gene does not by itself make the bacteria more “sticky,” i.e. contribute to increased adherence.\n\n\n\n\n\n\n3.4.3 The influence of batch effects\nAs noted above, the experiment as performed involved obtaining measurements in groups of five. Each group of five measurements may have been obtained on a different day, by a different scientist.\nSmall differences between the way scientists work, or batches of chemicals, media, and reagents, can lead to systematic differences in results that are due to those changes and not to the biological influence under investigation (here, the effect of the etpD gene on bacterial adherence).\n\n\n\n\n\n\nCaution\n\n\n\nWhen inspecting experimental data, you should check for potential signs of batch effects using exploratory data visualisation. The visualisation you performed above is exploratory data visualisation.\n\nDo datapoints that are meant to measure the same thing seem to form distinct and separate clusters?\nIf you colour the datapoints by a factor that is not meant to be a factor of interest in the experimental design (e.g. individual experimenter, date the measurement was obtained, media batch number) do these correlate with the clusters?\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nSome common visualisation and ordination techniques for identifying batch effects include PCA (principal components analysis) and MDS (multidimenstional scaling).\nRigorous experimental design is the best way to avoid batch effects and confounding. Techniques such as sample randomisation and statistical balancing can help to avoid unwanted and unanticipated batch effects.\n\n\n\n\n\n\n\n\nQuestion\n\n\n\nDo you see evidence of batch effects in Figure 3.1 and/or Figure 3.2? Why do you think this?\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\nThere is clear visual evidence of batch effects in both Figure 3.1 and/or Figure 3.2.\nFor example, in Figure 3.1 the logCFU values for batches 1 and 2 are obviously grouped together and differ from each other, despite apparently measuring the same values. The evidence for a batch effect is less obvious for batches 3 and 4.\nLikewise in Figure 3.2 the values for batch 5 are much lower than those for the other empty and complement batches. Values for batches 1 and 2 also appear to be systematically lower than for the other batches in the WT and KO lines.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Visualising Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html",
    "href": "modelling_data.html",
    "title": "4  Modelling Experimental Data",
    "section": "",
    "text": "4.1 Introduction\nIn Chapter 3 we used boxplots and scatterplots to visualise the data obtained from the adherence experiments with the wild-type (WT), knockout (KO), empty vector (empty), and complemented gene (complement) lines.\nWe saw that there appeared to be an effect of knocking out the etpD gene on the adherence (stickiness) of bacteria to both human tissue and to the catheter material. However, restoring the etpD gene appeared only to make a difference to adherence to the catheter material.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#introduction",
    "href": "modelling_data.html#introduction",
    "title": "4  Modelling Experimental Data",
    "section": "",
    "text": "Important\n\n\n\nWe also observed an apparent batch effect in both sets of experiments, where the results obtained appeared to be strongly affected by which experimental batch they were obtained in.\nWe should like to remove the influence of these batch effects as they make our results less reliable as a representation of the biological influence of the etpD gene.\n(we will do this in the next section, ?sec-removing-batch-effects)\n\n\n\n\n\n\n\n\nCaution\n\n\n\nAll our conclusions so far have been drawn from visual inspection of graphs, but we can do better than this by modelling the influence of biological factors of interest on our outcome (i.e. logCFU/mL).\nBy using statistical modelling approaches, we can estimate the quantitative influence of (i) knocking out the gene, (ii) introducing an empty plasmid, and (iii) reintroducing the gene as a complement and we shall do this below.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#the-model",
    "href": "modelling_data.html#the-model",
    "title": "4  Modelling Experimental Data",
    "section": "4.2 The Model",
    "text": "4.2 The Model\nWe can consider the measured “stickiness” or adherence of the bacteria to be composed of the combined influence of a number of factors. We can use our experimental results and a statistical method called linear modelling (or linear regression) to estimate the amount of influence each factor has.\nFirst though, we start with a baseline level of “stickiness…”\n\n4.2.1 The baseline: wild-type adherence (WT)\nThe wild-type (control) line is expected to display the baseline level of adherence for the bacteria.\nSo, when we measure the WT line we are establishing the natural baseline “stickiness” of the bacterium, measured as logCFU recovered from the substrate. In statistical terms we might make this into an equation like:\n\\[ \\textrm{measured logCFU} = \\textrm{baseline}  \\tag{4.1}\\]\nand Equation 4.1 says “the logCFU we measure for any wild-type bacterium is that of the baseline, wild-type organism.”\nIn reality though, we always expect some completely random experimental measurement error, which we can represent with the symbol \\(\\epsilon\\) (epsilon) as Equation 4.2:\n\\[ \\textrm{measured logCFU} = \\textrm{baseline} + \\epsilon  \\tag{4.2}\\]\ni.e. “the logCFU we measure for any wild-type bacterium is that of the baseline, wild-type organism, plus or minus some measurement error.”\n\n\n4.2.2 The first intervention: knocking out a gene of interest (KO)\nIf we don’t knock out a gene from a bacterium it is just the same as the wild type. We’d expect the logCFU we recover from the substrate to be the baseline logCFU.\nBut, if we do knock out a gene, we can represent the measured logCFU for that bacterium by Equation 4.3:\n\\[ \\textrm{measured logCFU} = \\textrm{baseline} + \\textrm{knockout} + \\epsilon  \\tag{4.3}\\]\nwhich says “the logCFU we measure for the bacterium is the baseline level, plus the effect of knocking out the gene.”\nEssentially the difference in measured logCFU between the WT and KO groups is taken to be due to the effect of knocking out the gene of interest (plus or minus a bit of measurement error).\n\n\n4.2.3 Introducing the empty vector (empty)\nIntroducing an empty plasmid vector puts strain on a bacterium and might affect its “stickiness.” As we only introduce the empty vector into a knockout strain, the measured logCFU for that bacterium is that of the baseline plus the effect of the knockout, and any effect of including the empty vector. We can describe this in Equation 4.4:\n\\[ \\textrm{measured logCFU} = \\textrm{baseline} + \\textrm{knockout} + \\textrm{empty} + \\epsilon  \\tag{4.4}\\]\nwhich says “the logCFU we measure for the bacterium is the baseline level, plus the effect of knocking out the gene of interest, and the effect of introducing an empty vector (plus or minus some measurement error).”\n\n\n4.2.4 Complementing the gene (complement)\nFinally, reintroducing the gene on the plasmid vector (complementing the gene) is expected to change the logCFU recovered. The effect of introducing the gene is added on to the effect of knocking it out and introducing an empty plasmid, and is described in Equation 4.5:\n\\[ \\textrm{measured logCFU} = \\textrm{baseline} + \\textrm{knockout} + \\textrm{empty} + \\textrm{complement} + \\epsilon  \\tag{4.5}\\]\n\n\n4.2.5 So what?\nBy now you might be thinking: “we’ve made an equation that represents the quantitative influence of knocking out a gene, introducing an empty plasmid, and complementing the gene, but so what? - how do we get numbers for this?”\nTo get those numbers, we can use a statistical technique called linear modelling (aka linear regression). It is very powerful and useful, and remarkably straightforward to use in R.\n\n\n\n\n\n\nNote\n\n\n\nWe will walk through the modelling process for the catheter data, but modelling the tissue data is left as an exercise for you to solve.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#fitting-the-catheter-model",
    "href": "modelling_data.html#fitting-the-catheter-model",
    "title": "4  Modelling Experimental Data",
    "section": "4.3 Fitting the catheter model",
    "text": "4.3 Fitting the catheter model\nWe will use the R built-in function lm() to fit the model in Equation 4.5 to our catheter dataset in the WebR cells below.\n\n4.3.1 Load the data\n\n\n\n\n\n\nImportant\n\n\n\nWe have preloaded the data for you as the dataframes tissue and catheter.\nUse the WebR cell below to confirm the catheter data is loaded\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\nNote that the data contains three columns: KO, empty, and complement that contain either a 1 or 0 value.\nThese columns describe whether the logCFU measurement in the row corresponds to a line that is affected by a gene knockout (KO = 1), the presence of a plasmid vector (empty = 1), or the reintroduced gene (complement = 1). These columns allow us to use the lm() function to estimate the influence of each biological intervention.\n\n\n\n\n\n\nNote\n\n\n\nWe assume that measurements of the bacteria all share the same (wild-type) baseline.\n\n\n\n\n4.3.2 Define the model\nR uses a specific syntax for defining a model, where factors of interest influence a measured value.\nHere, our measured value is in the column logCFU, and is assumed to be influenced by factors in the columns KO, empty, and complement (where they apply/are equal to one). We represent this with the R statement below:\nlogCFU ~ KO + empty + complement\nwhich reads: “logCFU is influenced by (~) the sum of effects of KO, empty, and complement (where they apply).”\n\n\n4.3.3 Fit the model\nTo fit our data to this model, we use this model definition in the lm() function as below (specifying that the dataframe we’re using is catheter):\ncatheter_model &lt;- lm(logCFU ~ KO + empty + complement, data=catheter)\n\n\n\n\n\n\nChallenge\n\n\n\nFit the catheter data to this model in the WebR cell below.\nUse the R code:\ncatheter_model &lt;- lm(logCFU ~ KO + empty + complement, data=catheter)\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#interpreting-the-catheter-model",
    "href": "modelling_data.html#interpreting-the-catheter-model",
    "title": "4  Modelling Experimental Data",
    "section": "4.4 Interpreting the catheter model",
    "text": "4.4 Interpreting the catheter model\nThe fitted model is stored in the variable catheter_model, and we can obtain useful information from it in a number of ways.\n\n4.4.1 Coefficients and confidence intervals\nThe coefficients that the model reports are the estimated effects of each factor of interest. To obtain the coefficients, use the R code below to produce a summary of the fitted model:\ncoef(catheter_model)\nThe confidence intervals reported by the model are the range of values that the model thinks are most likely for the coefficients. These work the same way as coefficients for t-tests and similar statistical methods: the range of values bounded by the 2.5% and 97.5% confidence limits is a 95% confidence interval. We would expect that the true value of the coefficient being estimated would lie in this range 95% of the time.\nTo find the confidence intervals for the coefficients of the model, use the R code below:\nconfint(catheter_model)\n\n\n\n\n\n\nChallenge\n\n\n\nFind the estimated coefficients and corresponding confidence intervals for the catheter model in the WebR cell below.\nUse the R code:\ncoef(catheter_model)\nconfint(catheter_model)\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n4.4.2 Reading the output\nYou should see output that resembles the data below:\n(Intercept)          KO       empty  complement \n  6.3382829  -0.3213144  -0.1465880   0.3986531 \n\n                  2.5 %      97.5 %\n(Intercept)  6.10862926 6.567936607\nKO          -0.64609377 0.003464903\nempty       -0.47136735 0.178191328\ncomplement   0.07387378 0.723432458\n\n4.4.2.1 Coefficients\nThe output of summary(catheter) shows values for each factor of interest in the column Estimate, plus a value for “(Intercept).”\n(Intercept)          KO       empty  complement \n  6.3382829  -0.3213144  -0.1465880   0.3986531 \n\n(Intercept) is the wild-type (WT)/control logCFU value coefficient estimate. Here this is 6.34, which looks to be a reasonable value by visual comparison with Figure 3.1.\nThe KO coefficient estimate is -0.32, which indicates that knocking out the etpD gene reduces the logCFU value by 0.32 units (as this is a log scale, that corresponds approximately to halving the number of recovered CFUs).\nThe empty coefficient estimate is -0.15, which indicates a further reduction in bacterial recovery is seen due to inserting the plasmid.\nThe complement coefficient estimate is 0.40 - of the same order as the reduction in logCFU seen for the gene knockout. This implies that returning the gene also restores bacterial recovery to the original, wild-type level.\n\n\n\n4.4.2.2 Confidence intervals\nThe confint(catheter) output lists the expected 95% confidence intervals for the coefficients.\n                  2.5 %      97.5 %\n(Intercept)  6.10862926 6.567936607\nKO          -0.64609377 0.003464903\nempty       -0.47136735 0.178191328\ncomplement   0.07387378 0.723432458\n\n\n\n\n\n\nTip\n\n\n\nThis is the more useful output for deciding whether there is a real effect due to a factor of interest\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe point estimate of a coefficient may be non-zero, implying a negative or positive effect of that factor on the measured outcome but, if the confidence interval includes zero it is not reasonable to exclude the possibility that there is actually no effect.\n\n\nIn this experiment, the confidence intervals tell us the following:\n\nThe (Intercept)/WT/baseline logCFU is likely to lie between 6.11 and 6.57 units\nThe effect of knocking out the gene (KO) is likely to lie between -0.646 and 0.003 units which appears to be a negative effect, but as the interval includes zero we cannot strictly rule out that there is no effect\nIntroduction of the plasmid vector changes logCFU by between -0.47 and 0.18 units which includes zero, and so we can’t rule out that there is no effect\nComplementing the etpD gene (complement) increases logCFU by between 0.074 and 0.72 units, enhancing recovery of bacteria\n\n\n\n\n\n\n\nCaution\n\n\n\nThese results taken together suggest that knocking out the etpD gene diminishes recovery of bacteria (implying reduced adherence) and that complementing the gene restores the recovery level. However, the statistics are equivoval because the KO confidence interval includes zero.\nWe can, however, be reasonably certain that addition of the empty vector does not appear to influence logCFU strongly, as the confidence interval includes zero.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#fitting-and-interpreting-the-tissue-model",
    "href": "modelling_data.html#fitting-and-interpreting-the-tissue-model",
    "title": "4  Modelling Experimental Data",
    "section": "4.5 Fitting and interpreting the tissue model",
    "text": "4.5 Fitting and interpreting the tissue model\n\n\n\n\n\n\nChallenge\n\n\n\nFit the tissue data to this model, using the WebR cell below.\nUse the R code:\ncatheter_model &lt;- lm(logCFU ~ KO + empty + complement, data=catheter)\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\n\n\nI need a hint\n\n\n\n\n\nUse the same functions as for the catheter model, but be sure to use the tissue dataset instead\n\nUse lm() to fit the model\nUse coef() and confint() to find the coefficients for the WT, KO, empty, and complement factors of interest\n\n\n\n\n\n\n\n\n\n\nHelp, I’m stuck!\n\n\n\n\n\nUse the R code below to fit the model\ntissue_model &lt;- lm(logCFU ~ KO + empty + complement, data=tissue)\nUse the R code below to see the estimated coefficients and confidence intervals\ncoef(tissue_model)\nconfint(tissue_model)\n\n\n\n\n4.5.1 Interpreting the results\n\n\n\n\n\n\nQuestions\n\n\n\nWhat are the coefficients of the four factors of interest, and what do they imply about the effects of each factor?\n\nWT/(Intercept)\nKO\nempty\ncomplement\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n&gt; coef(tissue_model)\n(Intercept)          KO       empty  complement \n 6.54455199 -0.30834731 -0.06356898 -0.05806111 \n\nThe (Intercept) value is 6.54, which is consistent with the baseline recovery from the catheter experiment\nThe KO value is -0.31, which is negative, so consistent with etpD deletion resulting in reduced recovery of bacteria/reduced adhesion\nThe empty value is -0.06 which is close to zero and consistent with there being no strong effect on logCFU due to incorporation of the plasmid vector\nThe complement value is -0.06 which is also small and close to zero, consistent with there being no strong effect on logCFU due to reintroduction of the etpD gene\n\n\n\n\n\n\n\n\n\n\nQuestions\n\n\n\nWhat are the confidence intervals for the coefficients of the four factors of interest, and what do they imply about the effects of each factor?\n\nWT/(Intercept)\nKO\nempty\ncomplement\n\n\n\n\n\n\n\n\n\nAnswers\n\n\n\n\n\n&gt; confint(tissue_model)\n                 2.5 %     97.5 %\n(Intercept)  6.4070598  6.6820442\nKO          -0.5027906 -0.1139040\nempty       -0.2580123  0.1308744\ncomplement  -0.2525044  0.1363822\n\nThe (Intercept) value lies between 6.41 and 6.68, which is consistent with the baseline recovery from the catheter experiment\nThe KO value lies between -0.50 and -0.11, which are both negative so this is consistent with etpD deletion resulting in reduced recovery of bacteria/reduced adhesion\nThe empty confidence interval includes zero and is consistent with there being no strong effect on logCFU due to incorporation of the plasmid vector\nThe complement confidence interval includes zero and is consistent with there being no strong effect on logCFU due to reintroduction of the etpD gene",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "modelling_data.html#but-wait",
    "href": "modelling_data.html#but-wait",
    "title": "4  Modelling Experimental Data",
    "section": "4.6 But wait!",
    "text": "4.6 But wait!\nBack in Chapter 3 we saw that the experimental data was affected by batch effects - systematic influences on the measured values that seemed to come from the way the experiment was conducted, not the biological factors whose influence we actually wanted to measure.\n\n\n\n\n\n\nCaution\n\n\n\nMaybe the results we have just obtained aren’t as correct, or at least as accurate, as they seem because of these systematic batch effects?\nWe should try to account for systematic batch effects as much as possible, and we’ll do this in the next section.",
    "crumbs": [
      "Correcting for batch effects",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Modelling Experimental Data</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "References"
    ]
  }
]